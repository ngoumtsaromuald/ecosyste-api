# Auth System Production Environment Template
# Copy this file to .env.auth.production and fill in the actual values
# NEVER commit the actual .env.auth.production file to version control

# =============================================================================
# CORE APPLICATION SETTINGS
# =============================================================================
NODE_ENV=production
PORT=3000
API_PREFIX=api/v1

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
DATABASE_URL="postgresql://username:password@host:port/database?schema=public"
DB_HOST=your-production-db-host
DB_PORT=5432
DB_USERNAME=your-db-username
DB_PASSWORD=your-secure-db-password
DB_NAME=romapi_core

# =============================================================================
# REDIS CONFIGURATION (Sessions & Caching)
# =============================================================================
REDIS_HOST=your-production-redis-host
REDIS_PORT=6379
REDIS_PASSWORD=your-secure-redis-password
REDIS_DB=0
SESSION_TTL=86400
REFRESH_TOKEN_TTL=604800

# =============================================================================
# JWT CONFIGURATION
# =============================================================================
# Generate strong secrets with: openssl rand -base64 64
JWT_SECRET=your-super-secure-jwt-secret-at-least-32-characters-long-change-this
JWT_ACCESS_EXPIRES=15m
JWT_REFRESH_SECRET=your-different-super-secure-refresh-secret-at-least-32-characters
JWT_REFRESH_EXPIRES=7d

# =============================================================================
# PASSWORD SECURITY
# =============================================================================
BCRYPT_ROUNDS=12
PASSWORD_RESET_EXPIRES=1h
EMAIL_VERIFICATION_EXPIRES=24h
MAX_LOGIN_ATTEMPTS=5
ACCOUNT_LOCKOUT_DURATION=15m

# =============================================================================
# EMAIL CONFIGURATION (SMTP with SSL/TLS)
# =============================================================================
SMTP_HOST=your-smtp-host.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-smtp-username
SMTP_PASS=your-smtp-password-or-app-password
EMAIL_FROM=noreply@yourdomain.com

# SSL/TLS Security Settings
SMTP_TLS_REJECT_UNAUTHORIZED=true
SMTP_TLS_MIN_VERSION=TLSv1.2

# =============================================================================
# OAUTH2 PROVIDERS (Optional - Configure only if using)
# =============================================================================

# Google OAuth2
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-client-secret

# GitHub OAuth2
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret

# LinkedIn OAuth2
LINKEDIN_CLIENT_ID=your-linkedin-client-id
LINKEDIN_CLIENT_SECRET=your-linkedin-client-secret

# =============================================================================
# FRONTEND & CALLBACK URLS (Must use HTTPS in production)
# =============================================================================
FRONTEND_URL=https://yourdomain.com
OAUTH_CALLBACK_URL=https://api.yourdomain.com/api/v1/auth/oauth
OAUTH_SUCCESS_REDIRECT=https://yourdomain.com/auth/success
OAUTH_ERROR_REDIRECT=https://yourdomain.com/auth/error

# =============================================================================
# RATE LIMITING & QUOTAS
# =============================================================================
RATE_LIMIT_TTL=60000
RATE_LIMIT_MAX=1000
API_KEY_RATE_LIMIT_DEFAULT=10000
USER_RATE_LIMIT_DEFAULT=1000
IP_RATE_LIMIT_DEFAULT=100

# =============================================================================
# API KEY CONFIGURATION
# =============================================================================
API_KEY_PREFIX=rk_prod_
API_KEY_DEFAULT_EXPIRY_DAYS=365
API_KEY_MAX_PER_USER=10

# =============================================================================
# SECURITY & CORS
# =============================================================================
# IMPORTANT: Use only your production domains, NO wildcards (*)
CORS_ORIGINS=https://yourdomain.com,https://api.yourdomain.com,https://admin.yourdomain.com

# Security Headers
HELMET_ENABLED=true
TRUST_PROXY=true
SECURE_COOKIES=true
SAME_SITE_COOKIES=strict

# =============================================================================
# AUDIT LOGGING & SECURITY MONITORING
# =============================================================================
AUDIT_LOG_ENABLED=true
AUDIT_LOG_LEVEL=info
AUDIT_LOG_RETENTION_DAYS=90
SECURITY_LOG_FILE=/app/logs/security/auth.log
SECURITY_LOG_DIR=/app/logs/security

# Alert Thresholds
FAILED_LOGIN_ALERT_THRESHOLD=10
RATE_LIMIT_ALERT_THRESHOLD=100
SUSPICIOUS_ACTIVITY_WINDOW=300
CRITICAL_EVENTS_ALERT_THRESHOLD=50

# =============================================================================
# MONITORING & METRICS
# =============================================================================
METRICS_ENABLED=true
HEALTH_CHECK_ENABLED=true
PROMETHEUS_METRICS_ENABLED=true

# =============================================================================
# CACHE CONFIGURATION (TTL in seconds)
# =============================================================================
CACHE_API_RESOURCE_TTL=7200
CACHE_CATEGORIES_TTL=172800
CACHE_SEARCH_TTL=3600
CACHE_USER_TTL=3600

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
LOG_LEVEL=info
LOG_FORMAT=json
LOG_RETENTION_ENABLED=true
LOG_ARCHIVE_LOCATION=/app/logs/archive

# =============================================================================
# PERFORMANCE & LIMITS
# =============================================================================
MAX_REQUEST_SIZE=10mb
REQUEST_TIMEOUT=30000

# =============================================================================
# SSL/TLS CONFIGURATION
# =============================================================================
SSL_ENABLED=true
SSL_CERT_PATH=/path/to/ssl/cert.pem
SSL_KEY_PATH=/path/to/ssl/private.key

# =============================================================================
# EXTERNAL INTEGRATIONS (Optional)
# =============================================================================
# Monitoring and Error Tracking
SENTRY_DSN=your-sentry-dsn-url
PROMETHEUS_PUSHGATEWAY_URL=your-prometheus-pushgateway-url

# Analytics (if needed)
ANALYTICS_API_KEY=your-analytics-api-key

# =============================================================================
# BACKUP & DISASTER RECOVERY
# =============================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_LOCATION=/app/backups

# =============================================================================
# DEVELOPMENT/TESTING OVERRIDES (Remove in production)
# =============================================================================
# These should be removed or commented out in production
# DEBUG_MODE=false
# SKIP_AUTH=false
# MOCK_EXTERNAL_SERVICES=false